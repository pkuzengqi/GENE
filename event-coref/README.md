# Event Coreference Resolution

## Instructions
You can install the dependencies for the project using the following command:
```
pip install -r requirements.txt
```

To train a baseline model, run the following command:
```
python runner.py -c basic
```
Arguments:
- -c, --config_name: Config name (default value is `basic`. See [configs/basic.conf](https://github.com/laituan245/gene-event-coref/blob/master/configs/basic.conf) for the list of configs).

The config `basic` is for the baseline model. To train a coref model that also uses GENE embeddings, run:
```
python runner.py -c with_gene_features --gene_variant ...
```
The list of variants is in the file `constants.py`. Also please change the [default directory path](constants.py#L18) to point to the location of the embeddings.

## Evaluation and Visualization
To evaluate and visualize the predictions of a trained model, run the following command:
```
python evaluate_and_visualize.py -c basic -m model.pt -o visualization.html
```
Arguments:
- -c, --config_name: Config name
- -m, --model_path: Path to the trained model
- -o, --output_path: Path to the visualization file to be generated by the script (default value is `visualization.html`)

## Data
Due to license issue, we cannot publicly share ACE 2005. Please download the data from the LDC website and process it using [OneIE](http://blender.cs.illinois.edu/software/oneie/)'s preprocessing code.

## Baseline Model Description
**SpanBERT model**

Given an input document, the model first forms a representation for each input token using a Transformer-based encoder (i.e., SpanBERT in this case). Different from [OneIE](https://www.aclweb.org/anthology/2020.acl-main.713/), we feed the entire document into the Transformer encoder (instead of encoding individual sentences one-by-one). The code of the encoder is in the file [models/encoder.py](https://github.com/laituan245/gene-event-coref/blob/master/models/encoder.py)

The vector representation of an event mention is the average of its token representations. Suppose we have two event mentions with representation v_i and v_j, then their coreference score is:

`s(i, j) = FFNN([v_i, v_j, v_i x v_j])`

Finally, we apply a ranking approach on top of these computed coreference scores (Similar to [Lee et. al 2017](https://arxiv.org/pdf/1707.07045.pdf) for entity coreference resolution).

**SpanBERT model + attribute features**

This variant is similar to the **SpanBERT** variant above. However, we simply include embeddings of attribute features when computing the coreference score:

`s(i, j) = FFNN([v_i, v_j, v_i x v_j, attribute_features])`

where `attribute_features` are features indicating whether the two event mentions have the same polarity/modality/genericity/tense or not.
